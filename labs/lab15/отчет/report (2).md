---
## Front matter
title: "Отчёт по лабораторной работе №15"
subtitle: "Управление логическими томами"
author: "Агджабекова Эся Рустамовна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки управления логическими томами.

# Ход выполнения работы

## Создание физического тома

1. В файле `/etc/fstab` были закомментированы строки автомонтирования каталогов `/mnt/data` и `/mnt/data-ext`. После этого выполнено их отмонтирование.

2. Командой `mount` без параметров проверено, что устройства `/dev/sdb` и `/dev/sdc` не подмонтированы.

3. С помощью `fdisk` выполнена новая разметка диска `/dev/sdb`: создан основной раздел размером 300 МБ и установлен тип `8e Linux LVM`. Скрин процесса разметки представлен на рис. [@fig:001].

![Разметка диска /dev/sdb](Screenshot_1.png){ #fig:001 width=70% }

4. Таблица разделов ядра обновлена командой `partprobe`. Затем просмотрена информация о разделах.

5. Раздел `/dev/sdb1` объявлен физическим томом LVM при помощи `pvcreate`.  
   Проверка командой `pvs` отражена на рис. [@fig:002].

![Создание PV и проверка pvs](Screenshot_2.png){ #fig:002 width=70% }

## Создание группы томов и логического тома

1. Командой `pvs` подтверждено наличие созданного физического тома.

2. Создана группа томов `vgdata` на основе `/dev/sdb1`.

3. Убедились в успешном создании группы через `vgs` и повторный `pvs`.

4. Создан логический том `lvdata`, использующий 50% свободного пространства группы.

5. Проверка созданного логического тома выполнена командой `lvs`.

6. На логическом томе создана файловая система ext4.

7. Создан каталог `/mnt/data` для монтирования.

8. В `/etc/fstab` добавлена строка автоматического монтирования.

9. Проверено корректное монтирование. Скрин показан на рис. [@fig:003].

![Создание LV, mkfs и монтирование](Screenshot_3.png){ #fig:003 width=70% }

## Изменение размера логических томов

1. Командами `pvs` и `vgs` просмотрена текущая конфигурация LVM.

2. На диске `/dev/sdb` создан дополнительный раздел `/dev/sdb2` типа 8e.

3. Новый раздел объявлен физическим томом.

4. Группа томов `vgdata` расширена за счёт `/dev/sdb2`.

5. Проверено увеличение размера группы (`vgs`).

6. Просмотрен текущий размер тома `lvdata` (`lvs`).

7. Проверен размер файловой системы (`df -h`).

8. Том `lvdata` увеличен на 50% свободного пространства. Скрин показан на рис. [@fig:005].

![Увеличение размера логического тома](Screenshot_5.png){ #fig:005 width=70% }

9. Выполнена проверка командой `df -h`, подтверждающая изменение размера (рис. [@fig:006]).

![Проверка размеров после увеличения](Screenshot_6.png){ #fig:006 width=70% }

10. Размер тома уменьшён на 50 МБ.

11. Повторная проверка после уменьшения представлена на рис. [@fig:007].

![Уменьшение размера логического тома](Screenshot_7.png){ #fig:007 width=70% }

## Самостоятельная работа

1. На диске `/dev/sdc` создан новый раздел размером 400 МБ, после чего записана новая таблица разделов. Скрин показан на рис. [@fig:008].

![Создание раздела /dev/sdc1](Screenshot_8.png){ #fig:008 width=70% }

2. Создан каталог `/mnt/groups` для постоянного монтирования логического тома.

3. На основе раздела `/dev/sdc1` создан физический том и группа томов `vggroup`.

4. Создан логический том `lvgroup`, использующий 100% свободного пространства группы томов.

5. Логический том отформатирован в файловой системе XFS. Все этапы отражены на рис. [@fig:009].

![Создание VG, LV и файловой системы XFS](Screenshot_9.png){ #fig:009 width=70% }

6. В файл `/etc/fstab` добавлена запись для постоянного монтирования:

Содержимое файла показано на рис. [@fig:010].

![Запись в fstab](Screenshot_10.png){ #fig:010 width=70% }

7. После выполнения `mount -a` подтверждено успешное монтирование, что видно на рис. [@fig:011].

![Проверка монтирования](Screenshot_11.png){ #fig:011 width=70% }

8. На диске создан второй раздел `/dev/sdc2` размером 300 МБ, преобразованный в LVM-раздел. Скрин — рис. [@fig:012].

![Создание раздела /dev/sdc2](Screenshot_12.png){ #fig:012 width=70% }

9. Создан физический том на `/dev/sdc2`.

10. Группа томов `vggroup` расширена за счёт нового PV.

11. Логический том `lvgroup` увеличен на всё доступное свободное пространство.  
   Благодаря поддержке XFS выполнено онлайн-расширение файловой системы.  
   Процесс отображён на рис. [@fig:013].

![Расширение VG и LV, рост XFS](Screenshot_13.png){ #fig:013 width=70% }

12. Проверка `pvs`, `vgs`, `lvs` и итогового размера файловой системы показана на рис. [@fig:014].

![Проверка итогового размера](Screenshot_14.png){ #fig:014 width=70% }

# Контрольные вопросы

1. **Какой тип раздела используется для LVM в таблице GUID?**  
   Используется тип раздела **GUID: `8e00` (Linux LVM)**.

2. **Как создать группу томов vggroup с физическим экстентом 4 MiB, используя /dev/sdb3?**  
   Команда:  
   `vgcreate -s 4M vggroup /dev/sdb3`

3. **Какая команда показывает краткую сводку физических томов и их принадлежность к группам?**  
   Команда:  
   `pvs`

4. **Что нужно сделать, чтобы добавить весь диск /dev/sdd в группу томов?**  
   Последовательность:  
   1) создать LVM-раздел на /dev/sdd (тип 8e)  
   2) создать физический том: `pvcreate /dev/sdd1`  
   3) расширить группу: `vgextend <VG> /dev/sdd1`

5. **Какая команда создаёт логический том lvvol1 размером 6 MiB?**  
   Команда:  
   `lvcreate -n lvvol1 -L 6M <VG>`

6. **Как добавить 100 МБ к логическому тому lvvol1?**  
   Команда:  
   `lvextend -L +100M /dev/<VG>/lvvol1`

7. **Первый шаг, если в группе томов нет свободного места, а нужно увеличить том на 200 МБ?**  
   Нужно **расширить группу томов**, добавив физический том:  
   `pvcreate …` → `vgextend …`

8. **Какая опция позволяет lvextend увеличивать файловую систему автоматически?**  
   Опция:  
   `-r`

9. **Как посмотреть доступные логические тома?**  
   Команда:  
   `lvs`

10. **Как проверить целостность файловой системы на /dev/vgdata/lvdata?**  
   Команда зависит от типа ФС:  
   * ext4 → `e2fsck -f /dev/vgdata/lvdata`  
   * xfs → `xfs_repair /dev/vgdata/lvdata`

# Заключение

В ходе лабораторной работы были последовательно выполнены операции по созданию и управлению логическими томами в среде LVM. Изучены процессы разметки дисков, подготовки физических томов, формирования групп томов и создания логических томов с последующим форматированием и монтированием. Отработаны навыки расширения томов и файловых систем, включая онлайн-увеличение для XFS. Получены практические знания по использованию инструментов LVM и конфигурации постоянных точек монтирования через файл `/etc/fstab`, что закрепило понимание принципов гибкого управления дисковым пространством в Linux.
